# 日本の祝日判定Rubyプログラム

([GitHub](https://github.com/masa16/holiday_japan)),
([RubyGems](https://rubygems.org/gems/holiday_japan))

## 特徴
* 1948年7月20日以降の日本の国民の祝日、振替休日、および国民の休日を計算して判定。
* スクリプトコード([holiday_japan.rb](https://github.com/masa16/holiday_japan/blob/master/lib/holiday_japan.rb))は、祝日データを含めて200行弱とコンパクト。

(date2 の holiday.rb と比較して)
* 祝日をキャッシュすることにより、大量の日付について祝日判定する場合でも高速に動作
* 祝日名を返すことが可能
* 祝日のルールをテーブルで持つことにより、法改正による祝日変更への対応が容易

## インストール

* RubyGems によるインストール
  ```
  gem install holiday_japan
  ```

* または、[holiday_japan.rb](https://github.com/masa16/holiday_japan/blob/master/lib/holiday_japan.rb)
  のスクリプトファイルを ruby のライブラリパスに置く

## 使い方

### モジュールをロード

  ```ruby
  require 'holiday_japan'
  ```

### HolidayJapan モジュール関数

* `check(date)` ― Dateクラスのオブジェクトによる祝日判定

  ```ruby
  HolidayJapan.check(Date.new(2019,3,21))
  => true
  ```

* `name(date)` ― 日付が祝日の場合は祝日名を返し、祝日でなければ nil を返す。

  ```ruby
  HolidayJapan.name(Date.new(2019,3,21))
  => "春分の日"
  ```

* `print_year(year)` ― ある年の祝日一覧をプリント

  ```
  $ ruby -r holiday_japan -e 'HolidayJapan.print_year 2019'
  listing year 2019...
  2019-01-01 Tue 元日
  2019-01-14 Mon 成人の日
  2019-02-11 Mon 建国記念の日
  2019-03-21 Thu 春分の日
  2019-04-29 Mon 昭和の日
  2019-04-30 Tue 国民の休日
  2019-05-01 Wed 即位の日（名称未定）
  2019-05-02 Thu 国民の休日
  2019-05-03 Fri 憲法記念日
  2019-05-04 Sat みどりの日
  2019-05-05 Sun こどもの日
  2019-05-06 Mon 振替休日
  2019-07-15 Mon 海の日
  2019-08-11 Sun 山の日
  2019-08-12 Mon 振替休日
  2019-09-16 Mon 敬老の日
  2019-09-23 Mon 秋分の日
  2019-10-14 Mon 体育の日
  2019-10-22 Tue 即位礼正殿の儀
  2019-11-03 Sun 文化の日
  2019-11-04 Mon 振替休日
  2019-11-23 Sat 勤労感謝の日
  ```

* `list_year(year)` ― ある年について、 [日付, 祝日名] のArrayを返す

  ```ruby
  HolidayJapan.list_year(2019)
  => [[#<Date: 2019-01-01 ((2458485j,0s,0n),+0s,2299161j)>, "元日"],
      [#<Date: 2019-01-14 ((2458498j,0s,0n),+0s,2299161j)>, "成人の日"],
      [#<Date: 2019-02-11 ((2458526j,0s,0n),+0s,2299161j)>, "建国記念の日"],
      [#<Date: 2019-03-21 ((2458564j,0s,0n),+0s,2299161j)>, "春分の日"],
      [#<Date: 2019-04-29 ((2458603j,0s,0n),+0s,2299161j)>, "昭和の日"],
      [#<Date: 2019-04-30 ((2458604j,0s,0n),+0s,2299161j)>, "国民の休日"],
      [#<Date: 2019-05-01 ((2458605j,0s,0n),+0s,2299161j)>, "即位の日（名称未定）"],
      [#<Date: 2019-05-02 ((2458606j,0s,0n),+0s,2299161j)>, "国民の休日"],
      [#<Date: 2019-05-03 ((2458607j,0s,0n),+0s,2299161j)>, "憲法記念日"],
      [#<Date: 2019-05-04 ((2458608j,0s,0n),+0s,2299161j)>, "みどりの日"],
      [#<Date: 2019-05-05 ((2458609j,0s,0n),+0s,2299161j)>, "こどもの日"],
      [#<Date: 2019-05-06 ((2458610j,0s,0n),+0s,2299161j)>, "振替休日"],
      [#<Date: 2019-07-15 ((2458680j,0s,0n),+0s,2299161j)>, "海の日"],
      [#<Date: 2019-08-11 ((2458707j,0s,0n),+0s,2299161j)>, "山の日"],
      [#<Date: 2019-08-12 ((2458708j,0s,0n),+0s,2299161j)>, "振替休日"],
      [#<Date: 2019-09-16 ((2458743j,0s,0n),+0s,2299161j)>, "敬老の日"],
      [#<Date: 2019-09-23 ((2458750j,0s,0n),+0s,2299161j)>, "秋分の日"],
      [#<Date: 2019-10-14 ((2458771j,0s,0n),+0s,2299161j)>, "体育の日"],
      [#<Date: 2019-10-22 ((2458779j,0s,0n),+0s,2299161j)>, "即位礼正殿の儀"],
      [#<Date: 2019-11-03 ((2458791j,0s,0n),+0s,2299161j)>, "文化の日"],
      [#<Date: 2019-11-04 ((2458792j,0s,0n),+0s,2299161j)>, "振替休日"],
      [#<Date: 2019-11-23 ((2458811j,0s,0n),+0s,2299161j)>, "勤労感謝の日"]]
  ```

* `hash_year(year)` ― ある年について、 {日付=>祝日名} のHashを返す

  ```ruby
  HolidayJapan.hash_year(2019)
  => {#<Date: 2019-01-01 ((2458485j,0s,0n),+0s,2299161j)>=>"元日",
      #<Date: 2019-01-14 ((2458498j,0s,0n),+0s,2299161j)>=>"成人の日",
      #<Date: 2019-02-11 ((2458526j,0s,0n),+0s,2299161j)>=>"建国記念の日",
      #<Date: 2019-03-21 ((2458564j,0s,0n),+0s,2299161j)>=>"春分の日",
      #<Date: 2019-04-29 ((2458603j,0s,0n),+0s,2299161j)>=>"昭和の日",
      #<Date: 2019-04-30 ((2458604j,0s,0n),+0s,2299161j)>=>"国民の休日",
      #<Date: 2019-05-01 ((2458605j,0s,0n),+0s,2299161j)>=>"即位の日（名称未定）",
      #<Date: 2019-05-02 ((2458606j,0s,0n),+0s,2299161j)>=>"国民の休日",
      #<Date: 2019-05-03 ((2458607j,0s,0n),+0s,2299161j)>=>"憲法記念日",
      #<Date: 2019-05-04 ((2458608j,0s,0n),+0s,2299161j)>=>"みどりの日",
      #<Date: 2019-05-05 ((2458609j,0s,0n),+0s,2299161j)>=>"こどもの日",
      #<Date: 2019-05-06 ((2458610j,0s,0n),+0s,2299161j)>=>"振替休日",
      #<Date: 2019-07-15 ((2458680j,0s,0n),+0s,2299161j)>=>"海の日",
      #<Date: 2019-08-11 ((2458707j,0s,0n),+0s,2299161j)>=>"山の日",
      #<Date: 2019-08-12 ((2458708j,0s,0n),+0s,2299161j)>=>"振替休日",
      #<Date: 2019-09-16 ((2458743j,0s,0n),+0s,2299161j)>=>"敬老の日",
      #<Date: 2019-09-23 ((2458750j,0s,0n),+0s,2299161j)>=>"秋分の日",
      #<Date: 2019-10-14 ((2458771j,0s,0n),+0s,2299161j)>=>"体育の日",
      #<Date: 2019-10-22 ((2458779j,0s,0n),+0s,2299161j)>=>"即位礼正殿の儀",
      #<Date: 2019-11-03 ((2458791j,0s,0n),+0s,2299161j)>=>"文化の日",
      #<Date: 2019-11-04 ((2458792j,0s,0n),+0s,2299161j)>=>"振替休日",
      #<Date: 2019-11-23 ((2458811j,0s,0n),+0s,2299161j)>=>"勤労感謝の日"}
  ```

* `between(from_date,to_date)` ― from_date から to_date までの祝日について、{日付=>祝日名}のHashを返す

  ```ruby
  HolidayJapan.between("2019-4-1","2020-3-31")
  => {#<Date: 2019-04-29 ((2458603j,0s,0n),+0s,2299161j)>=>"昭和の日",
      #<Date: 2019-04-30 ((2458604j,0s,0n),+0s,2299161j)>=>"国民の休日",
      #<Date: 2019-05-01 ((2458605j,0s,0n),+0s,2299161j)>=>"即位の日（名称未定）",
      #<Date: 2019-05-02 ((2458606j,0s,0n),+0s,2299161j)>=>"国民の休日",
      #<Date: 2019-05-03 ((2458607j,0s,0n),+0s,2299161j)>=>"憲法記念日",
      #<Date: 2019-05-04 ((2458608j,0s,0n),+0s,2299161j)>=>"みどりの日",
      #<Date: 2019-05-05 ((2458609j,0s,0n),+0s,2299161j)>=>"こどもの日",
      #<Date: 2019-05-06 ((2458610j,0s,0n),+0s,2299161j)>=>"振替休日",
      #<Date: 2019-07-15 ((2458680j,0s,0n),+0s,2299161j)>=>"海の日",
      #<Date: 2019-08-11 ((2458707j,0s,0n),+0s,2299161j)>=>"山の日",
      #<Date: 2019-08-12 ((2458708j,0s,0n),+0s,2299161j)>=>"振替休日",
      #<Date: 2019-09-16 ((2458743j,0s,0n),+0s,2299161j)>=>"敬老の日",
      #<Date: 2019-09-23 ((2458750j,0s,0n),+0s,2299161j)>=>"秋分の日",
      #<Date: 2019-10-14 ((2458771j,0s,0n),+0s,2299161j)>=>"体育の日",
      #<Date: 2019-10-22 ((2458779j,0s,0n),+0s,2299161j)>=>"即位礼正殿の儀",
      #<Date: 2019-11-03 ((2458791j,0s,0n),+0s,2299161j)>=>"文化の日",
      #<Date: 2019-11-04 ((2458792j,0s,0n),+0s,2299161j)>=>"振替休日",
      #<Date: 2019-11-23 ((2458811j,0s,0n),+0s,2299161j)>=>"勤労感謝の日",
      #<Date: 2020-01-01 ((2458850j,0s,0n),+0s,2299161j)>=>"元日",
      #<Date: 2020-01-13 ((2458862j,0s,0n),+0s,2299161j)>=>"成人の日",
      #<Date: 2020-02-11 ((2458891j,0s,0n),+0s,2299161j)>=>"建国記念の日",
      #<Date: 2020-02-23 ((2458903j,0s,0n),+0s,2299161j)>=>"天皇誕生日",
      #<Date: 2020-02-24 ((2458904j,0s,0n),+0s,2299161j)>=>"振替休日",
      #<Date: 2020-03-20 ((2458929j,0s,0n),+0s,2299161j)>=>"春分の日"}
  ```

### 祝日データをCSVに出力

  ```
  $ ruby -r csv -r holiday_japan -e 'CSV.open("holiday.csv","w"){|c| HolidayJapan.between(2018,2020).each{|a| c<<a}}'
  $ head -n3 holiday.csv ; echo ...; tail -n3 holiday.csv
  2018-01-01,元日
  2018-01-08,成人の日
  2018-02-11,建国記念の日
  ...
  2020-09-22,秋分の日
  2020-11-03,文化の日
  2020-11-23,勤労感謝の日
  ```

## 祝日データ

* 1948年7月20日(祝日法発令) 以降の祝日に対応
* 2019年の[暦要項](http://eco.mtk.nao.ac.jp/koyomi/yoko/)まで確認（法改正がない限り以降も有効）
* 春分の日・秋分の日の計算は2150年まで

## Author:
    Masahiro TANAKA

## Copyright:
    (C) Copyright 2003-2018 by Masahiro TANAKA
    This program is free software under MIT license.
    See LICENSE.txt.
    NO WARRANTY.

## Version:
    2018-04-14  ver 1.4  祝日データ仕様変更、2019,2020年対応
    2017-12-01  ver 1.3  print_between 関数追加
    2015-04-11  ver 1.2  hash_year, between 関数追加
    2014-05-23  ver 1.1  「山の日」追加
    2012-12-23  ver 1.0  モジュール名を Holiday から HolidayJapan に変更
    2007-08-02  ver 0.9  リファクタリング
    2007-03-08  ver 0.8  祝日データクラスを統一、データを配列で記述
    2006-02-06  ver 0.7  平成19年(西暦2007年)の暦要項 反映(祝日法改正)
                         Holiday.create_table 修正
                         Holiday.list_year 追加
    2003-10-02  ver 0.6  祝日データ追加
    2003-09-29  ver 0.5
    2003-09-22  ver 0.4
    2003-09-20  ver 0.3
    2003-09-16  ver 0.2
    2003-09-15  ver 0.1
